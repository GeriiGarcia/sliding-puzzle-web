<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sliding Puzzle</title>

    <style>
        *{
            padding: 0;
            margin: 0;
        }


        #juego{
            width: 22rem;
            height: 22rem;
            background-color: aqua;
            display: flex;
        }

        .pieza{
            width: 5rem;
            height: 5rem;
            background-color: yellow;
            border-width: 2px;
            border-style: solid;
            text-align: center;   
        }

        #pieza00{
            background-color: rgb(160,160,000);
        }
    </style>

    <script>
        let matriz_juego = [[1,2,3,4],[5,6,7,8],[9,10,11,12],[13,14,15,0]];

        /*Nos indica si puede moverse o no una pieza al espacio*/
        function puedeMoverse(num) { 

            /*tengo que sacar el numero por que paso el id de la pieza*/
            let numero = parseInt(num[num.length - 2] + num[num.length - 1]);
            
            /*busco el 0 i pongo su fila i su columna en variables     */                    /*   basicamente busco cada click donde esta el 0 ya que cuando genero el puzle aleatoriamente,
            /*miro que vecinos tiene  */                                                     /*   no puedo determinar donde esta el 0, podria determinar la posicion del 0 al principio del juego
            /*si uno de sus vecinos coincide con numero, entonces puede moverse    */        /*   y crear variables que sigan la posicion del 0 */
            let fila = 0;
            let columna = 0;
            for(let i = 0; i < matriz_juego.length; i++)
            {
                for (let j = 0; j < matriz_juego.length; j++) {
                    if (matriz_juego[i][j] == 0) {
                        fila = i;
                        columna = j;
                    }
                }
            }
            
            let vecinos = [];
            if(fila - 1 >= 0)
                vecinos.push(matriz_juego[fila-1][columna]);
            if(fila + 1 <= 3)
                vecinos.push(matriz_juego[fila+1][columna]);
            if(columna - 1 >= 0)
                vecinos.push(matriz_juego[fila][columna - 1]);
            if(columna + 1 <= 3)
                vecinos.push(matriz_juego[fila][columna+1]);

                
            if(vecinos.includes(numero))
            {
                for(let i = 0; i < matriz_juego.length; i++)
                {
                    for (let j = 0; j < matriz_juego.length; j++) {  
                        if(matriz_juego[i][j] == numero)
                            matriz_juego[i][j] = 0; 
                    }
                }
                matriz_juego[fila][columna] = numero;
                return true;
            }
                
            else
                return false;
        }

    

        document.addEventListener('click',function(ev){
            ev.preventDefault();
            if(ev.target.className == "pieza")
            {
                let idM = document.getElementById(ev.target.id).id;
                
                if(puedeMoverse(idM))
                {
                    /*cambio todo el html*/
                    let vacio = document.getElementById("pieza00");
                    let mover = document.getElementById("pieza" + idM[idM.length - 2] + idM[idM.length - 1]);

                    let idV = vacio.id;
                    let textM = mover.innerText;

                    vacio.innerText = textM;
                    mover.innerText = "";


                    vacio.id=mover.id;
                    mover.id = idV;
                }
                   
            }

        }, false);



    </script>
</head>
<body>
    
    <div id="juego">

        <table>
            <tr>
                <td><div class="pieza" id="pieza01">1</div></td>
                <td><div class="pieza" id="pieza02">2</div></td>
                <td><div class="pieza" id="pieza03">3</div></td>
                <td><div class="pieza" id="pieza04">4</div></td>
            </tr>
            <tr>
                <td> <div class="pieza" id="pieza05">5</div></td>
                <td><div class="pieza" id="pieza06">6</div></td>
                <td><div class="pieza" id="pieza07">7</div></td>
                <td><div class="pieza" id="pieza08">8</div></td>
            </tr>
            <tr>
                <td> <div class="pieza" id="pieza09">9</div></td>
                <td><div class="pieza" id="pieza10">10</div></td>
                <td><div class="pieza" id="pieza11">11</div></td>
                <td><div class="pieza" id="pieza12">12</div></td>
            </tr>
            <tr>
                <td><div class="pieza" id="pieza13">13</div></td>
                <td><div class="pieza" id="pieza14">14</div></td>
                <td><div class="pieza" id="pieza15">15</div></td>
                <td><div class="pieza" id="pieza00"></div></td>
            </tr>
        </table>

       
        
    </div>
</body>
</html>